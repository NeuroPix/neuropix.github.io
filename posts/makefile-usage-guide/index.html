<!DOCTYPE html>
<html lang="en-us"
  dir="ltr">

  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width">



<link rel="icon" type="image/ico" href="https://neuropix.github.io//favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://neuropix.github.io//favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://neuropix.github.io//favicon-32x32.png">
<link rel="icon" type="image/png" sizes="192x192" href="https://neuropix.github.io//android-chrome-192x192.png">
<link rel="apple-touch-icon" sizes="180x180" href="https://neuropix.github.io//apple-touch-icon.png">

<meta name="description" content=""/>

<title>
    
    Makefile 使用指南 | NeuroPix
    
</title>

<link rel="canonical" href="https://neuropix.github.io/posts/makefile-usage-guide/"/>












<link rel="stylesheet" href="/assets/combined.min.a6824bbee0d90d5af09fed9b70395ce7076b615e315037455d903314e96ef91b.css" media="all">









  </head>

  

  
  
  

  <body class="auto">

    <div class="content">
      <header>
        

<div class="header">

    

    <h1 class="header-title">NeuroPix</h1>

    <div class="flex">
        

        
        
      
        <p class="small ">
            <a href="/" >
                /home
            </a>
        </p>
        
      
        <p class="small ">
            <a href="/posts" >
                /posts
            </a>
        </p>
        
      
        <p class="small ">
            <a href="/about" >
                /about
            </a>
        </p>
        
        
    </div>

    

</div>

      </header>

      <main class="main">
        





<div class="breadcrumbs">
    
    <a href="/">Home</a>
    <span class="breadcrumbs-separator"> > </span>
    
    <a href="/posts/">Posts</a>
    <span class="breadcrumbs-separator"> > </span>
    
    <a class="breadcrumbs-current" href="/posts/makefile-usage-guide/">Makefile 使用指南</a>
</div>



<div >

  <div class="single-intro-container">

    

    <h1 class="single-title">Makefile 使用指南</h1>
    

    

    <p class="single-readtime">
      
      
      
      <time datetime="2024-09-27T10:00:00&#43;08:00">September 27, 2024</time>
      

      
    </p>

  </div>

  

  

  

  

  <div class="single-content">
    <p>在软件开发中，自动化构建和部署过程能够极大提高效率。<strong>Makefile</strong> 是一个用于自动化执行指令的工具，它允许开发者定义和管理项目的构建过程。本文将介绍 Makefile 的基本概念及其在项目中的使用方法。</p>
<h2 id="什么是-makefile">什么是 Makefile？</h2>
<p>Makefile 是一种文本文件，用于定义如何自动化执行任务，特别是在编译和链接程序时。它通常与 <code>make</code> 命令一起使用，可以根据文件的修改时间来决定哪些任务需要重新执行。</p>
<h2 id="makefile-的基本结构">Makefile 的基本结构</h2>
<p>一个简单的 Makefile 结构通常包括以下几个部分：</p>
<ul>
<li><strong>目标（Target）</strong>: 要生成的文件或要执行的任务。</li>
<li><strong>依赖（Dependencies）</strong>: 目标所依赖的文件。</li>
<li><strong>命令（Commands）</strong>: 生成目标所需执行的命令。</li>
</ul>
<p>例如：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-makefile" data-lang="makefile"><span style="display:flex;"><span><span style="color:#666;font-weight:bold;font-style:italic">target</span>: dependencies
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold;font-style:italic">command</span>
</span></span></code></pre></div><h2 id="makefile-示例">Makefile 示例</h2>
<p>下面是一个简单的 Makefile 示例，演示如何编译一个 C++ 项目：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-makefile" data-lang="makefile"><span style="display:flex;"><span><span style="color:#666;font-weight:bold;font-style:italic">CC</span> = g++
</span></span><span style="display:flex;"><span><span style="color:#666;font-weight:bold;font-style:italic">CFLAGS</span> = -Wall -g
</span></span><span style="display:flex;"><span><span style="color:#666;font-weight:bold;font-style:italic">SOURCES</span> = main.cpp utils.cpp
</span></span><span style="display:flex;"><span><span style="color:#666;font-weight:bold;font-style:italic">EXECUTABLE</span> = my_program
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#666;font-weight:bold;font-style:italic">all</span>: <span style="font-weight:bold;text-decoration:underline">$(</span><span style="color:#666;font-weight:bold;font-style:italic">SOURCES</span><span style="font-weight:bold;text-decoration:underline">)</span> <span style="font-weight:bold;text-decoration:underline">$(</span><span style="color:#666;font-weight:bold;font-style:italic">EXECUTABLE</span><span style="font-weight:bold;text-decoration:underline">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#666;font-weight:bold;font-style:italic">$(EXECUTABLE)</span>: <span style="font-weight:bold;text-decoration:underline">$(</span><span style="color:#666;font-weight:bold;font-style:italic">SOURCES</span><span style="font-weight:bold;text-decoration:underline">)</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold;text-decoration:underline">$(</span>CC<span style="font-weight:bold;text-decoration:underline">)</span> <span style="font-weight:bold;text-decoration:underline">$(</span>CFLAGS<span style="font-weight:bold;text-decoration:underline">)</span> <span style="font-weight:bold;text-decoration:underline">$(</span>SOURCES<span style="font-weight:bold;text-decoration:underline">)</span> -o <span style="font-weight:bold;text-decoration:underline">$(</span>EXECUTABLE<span style="font-weight:bold;text-decoration:underline">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#666;font-weight:bold;font-style:italic">clean</span>:
</span></span><span style="display:flex;"><span>    rm -f <span style="font-weight:bold;text-decoration:underline">$(</span>EXECUTABLE<span style="font-weight:bold;text-decoration:underline">)</span>
</span></span></code></pre></div><h3 id="解释">解释：</h3>
<ul>
<li><code>CC</code> 和 <code>CFLAGS</code> 是变量，分别代表编译器和编译选项。</li>
<li><code>SOURCES</code> 是源文件列表，<code>EXECUTABLE</code> 是最终生成的可执行文件。</li>
<li><code>all</code> 是默认目标，执行 <code>make</code> 时会调用它。</li>
<li><code>clean</code> 是清理目标，用于删除生成的可执行文件。</li>
</ul>
<h2 id="在项目中使用-makefile">在项目中使用 Makefile</h2>
<p>在项目中使用 Makefile，可以使构建、测试和部署过程更加高效。以下是一些常见的用法：</p>
<h3 id="1-自动化构建">1. 自动化构建</h3>
<p>使用 Makefile，可以定义自动化构建流程。例如，在你的项目中，可以创建一个目标用于编译源代码并生成可执行文件。</p>
<h3 id="2-管理依赖关系">2. 管理依赖关系</h3>
<p>Makefile 能够自动检测文件之间的依赖关系，确保在源文件修改后，相关目标能够被重新构建。</p>
<h3 id="3-执行测试">3. 执行测试</h3>
<p>可以在 Makefile 中定义测试目标，以便快速运行项目的测试用例。例如：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-makefile" data-lang="makefile"><span style="display:flex;"><span><span style="color:#666;font-weight:bold;font-style:italic">test</span>:
</span></span><span style="display:flex;"><span>    pytest tests/
</span></span></code></pre></div><h3 id="4-部署">4. 部署</h3>
<p>可以通过 Makefile 定义部署过程，例如将构建的文件推送到远程服务器。</p>
<h2 id="结论">结论</h2>
<p>Makefile 是一个强大且灵活的工具，能够帮助开发者自动化构建、测试和部署过程。通过合理地使用 Makefile，能够提高开发效率，减少重复劳动。希望本文能够帮助你更好地理解和使用 Makefile。</p>
<p>如有任何问题或建议，欢迎在评论区交流！</p>

    
  </div>

  


  

  
  

<div class="single-pagination">
    <hr />

    <div class="flex">

        <div class="single-pagination-prev">
            
            <div class="single-pagination-container-prev">
                <div class="single-pagination-text">←</div>
                <div class="single-pagination-text">
                    <a href="/posts/raspberry-pi-nas-setup/">
                        在 Debian 上安装 OpenMediaVault 的指南
                    </a>
                </div>
            </div>
            
        </div>

        <div class="single-pagination-next">
            
        </div>

    </div>

    <hr />
</div>



  

  

  
  <div class="back-to-top">
    <a href="#top">
      back to top
    </a>
  </div>
  

</div>


      </main>
    </div>

    <footer>
      

    
    <p>Powered by
        <a href="https://gohugo.io/">Hugo</a>
        and
        <a href="https://github.com/tomfran/typo">tomfran/typo</a>
    </p>
    
    
    



    </footer>
    
  </body>

  <script>

  function isAuto() {
    return document.body.classList.contains("auto");
  }

  function setTheme() {
    if (!isAuto()) {
      return
    }

    document.body.classList.remove("auto");
    let cls = "light";
    if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
      cls = "dark";
    }

    document.body.classList.add(cls);
  }

  function invertBody() {
    document.body.classList.toggle("dark");
    document.body.classList.toggle("light");
  }

  if (isAuto()) {
    window.matchMedia('(prefers-color-scheme: dark)').addListener(invertBody);
  }

  setTheme();

</script>

</html>